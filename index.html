<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Insight - Because context matters</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>

    html,body {
      margin: 0;
      height: 100%;
      overflow: auto;
    }
    /* Background image for the entire page */
    body {
      background-image: url('news_app.png');
      background-size: contain;
      background-position: left center; 
      background-repeat: no-repeat;
      background-attachment: scroll;
      background-color: #1a1a2e;
    }
    
    #background-video {
      position: fixed; /* Fixed positioning relative to viewport */
      right: 0; /* All the way to the right edge */
      top: 50%;
      transform: translateY(-50%);
      /* Responsive size: shrink on smaller windows, cap at original size */
      width: clamp(260px, 32vw, 500px);
      height: clamp(320px, 80vh, 600px);
      z-index: 20;
      object-fit: cover; /* Fill the area completely */
      border-radius: 20px; 
      /* box-shadow: 0 8px 30px rgba(17, 122, 207, 0.8); */
      border: 2px solid rgba(221, 199, 199, 0.897);
      background: #2a2a4a; /* Match the blue background better */
    }

    /* Extra safety on very short viewports */
    @media (max-height: 650px) {
      #background-video {
        height: clamp(260px, 70vh, 600px);
      }
    }
    .brand {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0 auto;
      color: #fff;
      text-shadow: 0 2px 8px rgba(0,0,0,.7);
      z-index: 2; /* Make sure text appears above video */
      position: relative;
    }
    .brand b {
      font-size: 5em;
      font-weight: bold;
      text-align: center;
    }
    .brand p {
      font-size: 2em;
      font-weight: bold;
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <!-- background video (autoplays muted inline on mobile) -->
  <video
    id="background-video"
    src="news_test_app_10-9-25.mp4"
    autoplay
    loop
    muted
    playsinline
    webkit-playsinline
    controls
    preload="auto"
    crossorigin="anonymous"
  ></video>

  <!-- debug log panel (bottom-left) -->
  <div id="video-log" style="position:fixed;left:8px;bottom:8px;max-width:44vw;max-height:40vh;overflow:auto;background:rgba(0,0,0,.6);color:#e5e7eb;padding:8px 10px;border-radius:8px;font:12px/1.4 system-ui, sans-serif;z-index:9998;backdrop-filter:saturate(1.2) blur(2px)">
    <div style="font-weight:700;margin-bottom:6px">Video debug log</div>
    <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:6px">
      <button id="retry-play" style="all:unset;background:#2563eb;color:#fff;padding:4px 8px;border-radius:6px;cursor:pointer">Retry ‚ñ∂</button>
      <a href="news_test_app_10-9-25.mp4" target="_blank" style="color:#93c5fd;text-decoration:underline">Open file directly</a>
    </div>
    <pre id="video-log-lines" style="margin:0;white-space:pre-wrap"></pre>
  </div>

  <!-- simple status badge for quick live checks -->
  <div id="video-status" style="position:fixed;right:8px;bottom:8px;background:rgba(0,0,0,.6);color:#fff;padding:6px 10px;border-radius:8px;font:12px/1.2 system-ui, sans-serif;z-index:9999">loading‚Ä¶</div>

  <header>
    <div class="container nav" style="text-align: center;">
      <div class="brand">
        <b>Insight</b>
        <p>Because context matters</p>
      </div>
    </div>
  </header>

  <main></main>
  <footer></footer>

  <script>
  // Enhanced video debugging + on-screen status
    const video = document.getElementById('background-video');
    const statusEl = document.getElementById('video-status');
    const logBox = document.getElementById('video-log-lines');
    const retryBtn = document.getElementById('retry-play');
  const setStatus = (t) => statusEl && (statusEl.textContent = t);
    const log = (...args) => {
      const msg = args.map(x => typeof x === 'object' ? JSON.stringify(x) : String(x)).join(' ');
      console.log(msg);
      if (logBox) {
        const time = new Date().toLocaleTimeString();
        logBox.textContent += `[${time}] ${msg}\n`;
        logBox.scrollTop = logBox.scrollHeight;
      }
    };

    const readyStateNames = ['HAVE_NOTHING','HAVE_METADATA','HAVE_CURRENT_DATA','HAVE_FUTURE_DATA','HAVE_ENOUGH_DATA'];
    const networkStateNames = ['NETWORK_EMPTY','NETWORK_IDLE','NETWORK_LOADING','NETWORK_NO_SOURCE'];
    
    // More comprehensive event listeners
    video.addEventListener('loadstart', () => {
      setStatus('loading‚Ä¶');
      log('‚úÖ loadstart');
    });
    
    video.addEventListener('loadedmetadata', () => {
      setStatus('metadata loaded');
      log('‚úÖ loadedmetadata duration=', video.duration, 'size=', video.videoWidth+'x'+video.videoHeight, 'readyState=', readyStateNames[video.readyState] || video.readyState);
    });
    
    video.addEventListener('loadeddata', () => {
      setStatus('data loaded');
      log('‚úÖ loadeddata');
    });
    
    video.addEventListener('canplay', () => {
      setStatus('can play');
      log('‚úÖ canplay');
      video.play().then(()=>{ setStatus('playing'); log('‚ñ∂ playing'); }).catch(e => { setStatus('autoplay blocked'); log('‚ùå autoplay failed', e?.name || e); });
    });
    
    video.addEventListener('canplaythrough', () => {
      setStatus('can play through');
      log('‚úÖ canplaythrough');
    });
    
    video.addEventListener('error', (e) => {
      setStatus('error');
      log('‚ùå error code=', video.error?.code, 'message=', video.error?.message);
      if (video.error?.code === 4) {
        setStatus('format not supported');
        log('üîÑ trying reload same src');
        video.src = './news_test_app_10-9-25.mp4';
        video.load();
      }
    });
    
  video.addEventListener('stalled', () => { setStatus('stalled'); log('‚ö†Ô∏è stalled'); });
    
  video.addEventListener('suspend', () => { setStatus('suspended'); log('‚ö†Ô∏è suspend'); });
    
  video.addEventListener('abort', () => { setStatus('aborted'); log('‚ö†Ô∏è abort'); });
    
    // Force video setup
    video.style.display = 'block';
    
    // Multiple attempts to load and play
    setTimeout(() => {
      log('üîÑ load attempt #1');
      video.load();
      setTimeout(() => {
        log('üîÑ play attempt #1');
        video.play().then(() => { setStatus('playing'); log('‚ñ∂ playing'); })
          .catch(e => {
            setStatus('manual play required');
            log('‚ùå play failed #1', e?.name || e);
            log('üîÑ set direct src and retry');
            video.src = 'news_test_app_10-9-25.mp4';
            video.load();
            setTimeout(() => {
              video.play().then(()=>{ setStatus('playing'); log('‚ñ∂ playing after direct src'); })
                .catch(e2 => { setStatus('click play ‚ñ∂'); log('‚ùå play failed #2', e2?.name || e2); });
            }, 1000);
          });
      }, 1500);
    }, 500);

    // Periodic state sampler
    setInterval(() => {
      const info = {
        readyState: readyStateNames[video.readyState] || video.readyState,
        networkState: networkStateNames[video.networkState] || video.networkState,
        currentTime: video.currentTime,
        duration: video.duration,
        paused: video.paused,
        ended: video.ended,
        src: video.currentSrc || video.src || '(none)'
      };
      log('‚ÑπÔ∏è state', info);
    }, 5000);

    // Retry button
    if (retryBtn) {
      retryBtn.addEventListener('click', () => {
        setStatus('retrying‚Ä¶');
        log('üîÅ manual retry clicked');
        video.pause();
        video.load();
        video.play().then(()=>{ setStatus('playing'); log('‚ñ∂ playing after retry'); })
          .catch(e => { setStatus('click play ‚ñ∂'); log('‚ùå retry play failed', e?.name || e); });
      });
    }
    
    // Check video source accessibility
  fetch('./news_test_app_10-9-25.mp4', { method: 'HEAD' })
      .then(response => {
    log('üìÅ HEAD status=', response.status, 'type=', response.headers.get('content-type'), 'bytes=', response.headers.get('content-length'));
      })
      .catch(e => {
    log('‚ùå HEAD failed with ./ prefix', e?.name || e);
    log('üîÑ Trying without ./ prefix...');
        
    fetch('news_test_app_10-9-25.mp4', { method: 'HEAD' })
          .then(response => {
      log('üìÅ HEAD (no prefix) status=', response.status);
          })
          .catch(e2 => {
      log('‚ùå HEAD failed (no prefix)', e2?.name || e2);
          });
      });
  </script>
</body>
</html>
